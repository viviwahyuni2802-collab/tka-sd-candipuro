<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Tes Kemampuan Akademik</title>
<title>Kecamatan Candipuro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { font-family: Arial; background:#eef2f7; margin:0; padding:10px; }
.container { max-width:700px; margin:auto; background:white; padding:15px; border-radius:10px; }
h2 { text-align:center; }
input, select, button {
  width:100%; padding:10px; margin:8px 0;
  font-size:16px;
}
button { background:#1e88e5; color:white; border:none; border-radius:6px; }
button:hover { background:#1565c0; }
.soal { margin:15px 0; }
.timer { font-size:18px; color:red; text-align:center; font-weight:bold; }
.hasil { text-align:center; font-size:20px; color:green; font-weight:bold; }
@media (max-width:600px){
  h2 { font-size:20px; }
}
</style>
</head>

<body>
<div class="container">

<h2>ðŸ“˜ Quiz Digital SD</h2>

<div id="login">
  <input id="nama" placeholder="Nama Murid">
  <input id="lembaga" placeholder="Asal Lembaga">
  <select id="mapel">
    <option value="">Pilih Mata Pelajaran</option>
    <option value="mtk">Matematika</option>
    <option value="indo">Bahasa Indonesia</option>
  </select>
  <select id="paket"></select>
  <button onclick="mulai()">Mulai Quiz</button>
</div>

<div class="timer" id="timer"></div>
<div id="soalArea"></div>
<div class="hasil" id="hasil"></div>

<button id="download" onclick="downloadCSV()" style="display:none">
â¬‡ Download Rekap Nilai (Excel)
</button>

</div>

<script>
// ================= BANK SOAL =================
const BANK_SOAL = {
  mtk:{
    1:[
      {t:"6 + 4 = ...", p:["8","9","10","11"], j:2},
      {t:"5 x 3 = ...", p:["10","15","20","25"], j:1},
      {t:"12 : 4 = ...", p:["2","3","4","5"], j:1}
    ]
  },
  indo:{
    1:[
      {t:"Baca dengan seksama teks berikut untuk menjawab soal nomor 1 sampai 3!Pesona Pasir Vulkanik Lumajang
Lumajang, sebuah permata tersembunyi di Jawa Timur, menyimpan keindahan alam yang memukau, salah satunya adalah hamparan pasir vulkaniknya yang unik. Terbentuk dari endapan abu vulkanik Gunung Semeru yang aktif, pasir ini memiliki karakteristik yang khas dan membedakannya dari pasir pantai pada umumnya. Warna abu-abu kehitaman yang mendominasi memberikan kesan dramatis dan eksotis, terutama saat berpadu dengan birunya langit dan hijaunya pepohonan di sekitarnya.
Tekstur pasir Lumajang sangat halus dan lembut, sehingga nyaman untuk dipijak dan dimainkan. Butiran-butiran pasir yang kaya akan mineral ini juga memiliki manfaat bagi masyarakat setempat. Selain digunakan sebagai bahan bangunan yang berkualitas, pasir Lumajang juga menjadi sumber penghidupan bagi para penambang tradisional.
Keindahan pasir Lumajang semakin mempesona dengan latar belakang Gunung Semeru yang menjulang tinggi. Pemandangan ini menjadi daya tarik utama bagi wisatawan, terutama para fotografer yang ingin mengabadikan momen-momen indah. Selain itu, aktivitas seperti off-road, sandboarding, dan berkemah juga populer di kalangan pengunjung yang mencari pengalaman petualangan yang tak terlupakan. Pasir Lumajang bukan hanya sekadar hamparan pasir, tetapi juga sebuah ekosistem yang unik dan berharga.
Ciri khas pasir Lumajang adalah  â€¦.", p:["warna putih berkilauan","warna abu-abu kehitaman","tekstur kasar seperti kerikil"aroma wangi seperti bunga"], j:1}
    ]
  }
};
// =============================================

let dataRekap = [];
let waktu = 7200; // 120 menit
let timerInterval;

function mulai(){
  const mapel = document.getElementById("mapel").value;
  const paket = document.getElementById("paket").value;
  if(!BANK_SOAL[mapel] || !BANK_SOAL[mapel][paket]){
    alert("Soal belum tersedia");
    return;
  }

  document.getElementById("login").style.display="none";
  tampilkanSoal(mapel, paket);
  mulaiTimer();
}

function tampilkanSoal(mapel, paket){
  const area = document.getElementById("soalArea");
  area.innerHTML="";
  const soal = shuffle([...BANK_SOAL[mapel][paket]]);

  soal.forEach((s,i)=>{
    const opsi = shuffle([...s.p]);
    area.innerHTML += `
      <div class="soal">
        <p>${i+1}. ${s.t}</p>
        ${opsi.map(o=>`
          <label><input type="radio" name="s${i}" value="${o}"> ${o}</label><br>
        `).join("")}
      </div>`;
    s.opsi = opsi;
  });

  area.innerHTML += `<button onclick="selesai()">Selesai</button>`;
  window.soalAktif = soal;
}

function mulaiTimer(){
  timerInterval = setInterval(()=>{
    waktu--;
    document.getElementById("timer").innerText =
      "Sisa Waktu: " + Math.floor(waktu/60) + ":" + (waktu%60).toString().padStart(2,"0");
    if(waktu<=0){
      clearInterval(timerInterval);
      selesai();
    }
  },1000);
}

function selesai(){
  clearInterval(timerInterval);
  let benar = 0;
  soalAktif.forEach((s,i)=>{
    const jawab = document.querySelector(`input[name="s${i}"]:checked`);
    if(jawab && s.opsi.indexOf(jawab.value) === s.j) benar++;
  });

  const nilai = Math.round((benar/soalAktif.length)*100);
  document.getElementById("hasil").innerText = "Nilai Anda: " + nilai;

  dataRekap.push({
    nama:nama.value,
    lembaga:lembaga.value,
    mapel:mapel.value,
    paket:paket.value,
    nilai:nilai
  });

  document.getElementById("download").style.display="block";
}

function downloadCSV(){
  let csv = "Nama,Lembaga,Mapel,Paket,Nilai\n";
  dataRekap.forEach(d=>{
    csv += `${d.nama},${d.lembaga},${d.mapel},${d.paket},${d.nilai}\n`;
  });
  const blob = new Blob([csv], {type:"text/csv"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "rekap_nilai.csv";
  a.click();
}

function shuffle(arr){
  return arr.sort(()=>Math.random()-0.5);
}

for(let i=1;i<=22;i++){
  paket.innerHTML += `<option value="${i}">Paket ${i}</option>`;
}
</script>
</body>
</html>
